# Протокол Диффи-Хеллмана

## **Введение**
Протокол Диффи-Хеллмана — это криптографический метод обмена ключами, предложенный в 1976 году Уитфилдом Диффи и Мартином Хеллманом.  
Протокол позволяет двум сторонам безопасно обмениваться ключом через небезопасный канал связи.  
Это первый пример использования асимметричного криптографического подхода для распределённого обмена секретными данными.

---

## **Математические основы**
Протокол основан на задаче вычисления дискретного логарифма. Он использует **модульную арифметику** и **первичные корни** в конечной группе вычетов.

1. Выбирается большое простое число $p$ и его первичный корень $g$.  
2. Секретные ключи $a$ и $b$ выбираются случайным образом:
   - $a$ — секретный ключ первой стороны.
   - $b$ — секретный ключ второй стороны.

3. Открытые ключи вычисляются следующим образом:
   - $A = g^a \mod p$ — открытый ключ первой стороны.
   - $B = g^b \mod p$ — открытый ключ второй стороны.

4. Каждая сторона может обмениваться своим открытым ключом по небезопасному каналу.

---

## **Шаги протокола**

### **Шаг 1: Обмен открытыми ключами**
1. Сторона 1 выбирает секретный ключ $a$ и вычисляет $A = g^a \mod p$.
2. Сторона 2 выбирает секретный ключ $b$ и вычисляет $B = g^b \mod p$.
3. Стороны обмениваются открытыми значениями $A$ и $B$ по небезопасному каналу.

### **Шаг 2: Вычисление общего секрета**
1. Сторона 1 использует свой секретный ключ $a$ и открытый ключ $B$ от второй стороны для вычисления общего секрета:
   $$ S_1 = B^a \mod p $$

2. Сторона 2 использует свой секретный ключ $b$ и открытый ключ $A$ от первой стороны для вычисления общего секрета:
   $$ S_2 = A^b \mod p $$

Из-за свойств модульной арифметики, $S_1 = S_2$:
$$ S_1 = B^a \mod p = (g^b)^a \mod p = g^{ab} \mod p $$  
$$ S_2 = A^b \mod p = (g^a)^b \mod p = g^{ab} \mod p $$

Обе стороны получают один и тот же общий секрет $S = g^{ab} \mod p$.

---

## **Пример работы**
1. Пусть $p = 23$, $g = 5$.
2. Сторона 1 выбирает секретный ключ $a = 6$, тогда $A = 5^6 \mod 23 = 8$.
3. Сторона 2 выбирает секретный ключ $b = 15$, тогда $B = 5^{15} \mod 23 = 19$.

Они обмениваются $A = 8$ и $B = 19$.

4. Сторона 1 вычисляет:
   $$ S_1 = 19^6 \mod 23 = 2 $$

5. Сторона 2 вычисляет:
   $$ S_2 = 8^{15} \mod 23 = 2 $$

Общий секрет: $S = 2$.

---

## **Безопасность протокола**
Протокол Диффи-Хеллмана безопасен при условии, что вычисление дискретного логарифма в выбранной группе остаётся вычислительно сложной задачей.  
Злоумышленник, перехвативший $A$ и $B$, не сможет вычислить общий секрет, если задача дискретного логарифма для выбранных параметров остаётся трудной.

### **Уязвимости**
- **Атака "человек посередине" (MITM)**: Злоумышленник может подменить открытые ключи $A$ и $B$, установив свой собственный открытый ключ для каждой стороны.  
  Для защиты от MITM в протокол добавляются цифровые подписи или другие методы аутентификации.

---

## **Применение**
Протокол Диффи-Хеллмана широко используется для **обмена ключами** в различных криптографических системах, таких как:
- **TLS/SSL** для безопасного обмена ключами в интернете.
- **IPSec** для защиты сетевых соединений.
- **SSH** для защищённого удалённого доступа.

---

## **Заключение**
Протокол Диффи-Хеллмана стал основой для многих современных криптографических протоколов и остаётся важным элементом в криптографических библиотеках. Он предоставляет надёжный способ обмена секретными ключами через небезопасные каналы, однако для полной безопасности необходимо дополнительно обеспечивать защиту от атак, таких как MITM.
