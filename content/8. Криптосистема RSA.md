## Введение
**RSA (Rivest–Shamir–Adleman)** — одна из первых и наиболее широко используемых асимметричных криптосистем.  
Основана на сложности разложения больших чисел на простые множители (**факторизация**).  

**Ключевые свойства RSA**:
- Позволяет **шифровать данные** и **создавать электронные подписи**.
- Основана на **модульной арифметике** и **функции Эйлера**.
- Безопасность обеспечивается сложностью разложения числа на простые множители.

---

## **Математические основы**
RSA использует конечные поля и свойства модульной арифметики.
### **1. Генерация ключей**
1. Выбираются два **простых числа** $p$ и $q$ (секретные).
2. Вычисляется их произведение (**модуль**):  
   $$ n = p \cdot q $$
3. Вычисляется функция Эйлера:
   $$ \varphi(n) = (p - 1)(q - 1) $$
4. Выбирается открытая экспонента $e$, такая что:
   $$ 1 < e < \varphi(n), \quad \gcd(e, \varphi(n)) = 1 $$
   - Обычно $e = 65537$ (часто используемое значение).
5. Вычисляется **закрытая экспонента** $d$:
   $$ d \equiv e^{-1} \mod \varphi(n) $$
   - Это **мультипликативно обратное** к $e$ по модулю $\varphi(n)$.
   - Вычисляется с помощью **расширенного алгоритма Евклида**.

Итоговая пара ключей:
- **Открытый ключ**: $(n, e)$ — используется для шифрования и проверки подписи.
- **Закрытый ключ**: $(n, d)$ — используется для расшифрования и создания подписи.

---

## **Шифрование и расшифрование**
### **Шифрование**
Отправитель шифрует сообщение $P$ с использованием открытого ключа:
$$ C = P^e \mod n $$
Где:
- $P$ — исходное сообщение (число),
- $C$ — зашифрованное сообщение (шифротекст).

### **Расшифрование**
Получатель расшифровывает $C$ с использованием закрытого ключа:
$$ P = C^d \mod n $$

**Корректность** расшифрования объясняется тем, что:
$$ (P^e)^d \equiv P^{ed} \equiv P \mod n $$  
Так как $d$ и $e$ связаны соотношением:
$$ d \cdot e \equiv 1 \mod \varphi(n) $$  
Из теоремы Эйлера следует:
$$ P^{\varphi(n)} \equiv 1 \mod n $$
Это гарантирует, что после возведения в степень $d$ исходное сообщение восстанавливается.

---

## **Электронная подпись**
RSA также используется для цифровой подписи сообщений.
### **Создание подписи**
Отправитель вычисляет подпись для сообщения $M$:
$$ S = M^d \mod n $$
- Подпись $S$ отправляется вместе с $M$.
### **Проверка подписи**
Получатель проверяет подпись, используя открытый ключ:
$$ M' = S^e \mod n $$
Если $M' = M$, подпись верна.

---

## **Пример работы RSA**
**Дано**:  
- Простые числа: $p = 61$, $q = 53$  
- Модуль: $n = 61 \times 53 = 3233$  
- Функция Эйлера: $\varphi(n) = (61 - 1)(53 - 1) = 3120$  
- Выбираем $e = 17$  
- Вычисляем $d$:  
  $$ d \equiv 17^{-1} \mod 3120 = 2753 $$

**Шифрование**:  
Пусть $P = 65$. Тогда:  
$$ C = 65^{17} \mod 3233 = 2790 $$  

**Расшифрование**:  
$$ P = 2790^{2753} \mod 3233 = 65 $$  
Исходное сообщение восстановлено.

---

## **Безопасность RSA**
RSA считается безопасным, если **размер ключа достаточно велик**.

### **Основная сложность**
Безопасность RSA основана на задаче **факторизации числа $n$**.  
- Если злоумышленник разложит $n$ на $p$ и $q$, он сможет вычислить $d$.
- **Современные методы факторизации**:
  - Метод квадратичного решета.
  - Алгоритм числового решета.

### **Атаки на RSA**
1. **Факторизация $n$**  
   - Чем больше $n$, тем сложнее разложить его на множители.
   - Рекомендуемый размер $n$: **2048+ бит**.
   
2. **Атака на малый $e$**  
   - Если $e$ мало, злоумышленник может попытаться вычислить $C^{1/e}$.
   - Защита: Использовать **padding** (PKCS#1).

3. **Атаки с боковыми каналами**  
   - Измерение времени вычислений или потребляемой энергии может раскрыть $d$.
   - Защита: использование **случайных задержек**.

4. **Атаки с подставными значениями**  
   - Если злоумышленник выбирает специальные $C$, он может восстановить информацию о $d$.
   - Защита: дополнительные проверки при расшифровании.

5. **Квантовые атаки**  
   - Алгоритм Шора на **квантовом компьютере** решает задачу факторизации за **полиномиальное время**.
   - RSA будет небезопасен при появлении мощных квантовых компьютеров.

---

## **Практическое применение**
RSA используется в большинстве современных систем:
- **TLS/SSL** (защита интернет-трафика).
- **Электронная подпись** (PKCS#1, PGP, GOST).
- **Аутентификация** (SSH, OpenVPN).
- **Криптовалюты** (Bitcoin, Ethereum).

### **Комбинированное использование**
RSA медленный, поэтому применяется **гибридное шифрование**:
- **AES** используется для шифрования данных.
- **RSA** применяется для шифрования ключа AES.

---

## **Длина ключа и безопасность**
Рекомендуемые размеры ключей:
- **1024 бит** – устаревший, небезопасный.
- **2048 бит** – минимум для современных систем.
- **4096 бит** – долгосрочная безопасность.

### **Сравнение RSA с другими алгоритмами**
| Алгоритм     | Безопасность | Скорость шифрования | Скорость подписи |
|-------------|-------------|---------------------|-----------------|
| RSA 2048    | Надежен    | Медленный          | Средний        |
| ECC (256 бит)| Надежен    | Быстрее RSA        | Быстрее RSA    |
| AES 256     | Надежен    | Очень быстрый      | Нет подписи    |

---

## **Заключение**
RSA остается одним из ключевых алгоритмов в криптографии, но его **будущее под угрозой из-за квантовых атак**.  
Поэтому в перспективе его заменят **постквантовые алгоритмы** (CRYSTALS-Kyber, NTRU, и др.).
