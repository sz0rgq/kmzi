## Введение
**AES (Advanced Encryption Standard)** — современный симметричный блочный шифр, утверждённый в 2001 году в качестве стандарта шифрования США (FIPS 197). Он пришел на замену **DES** и его усовершенствованной версии **3DES**.

AES обладает высокой криптографической стойкостью и используется в большинстве современных криптографических систем.

### **Основные параметры**
| Параметр      | Значение                                 |
| ------------- | ---------------------------------------- |
| Размер блока  | 128 бит                                  |
| Длина ключа   | 128, 192 или 256 бит                     |
| Число раундов | 10 (128 бит), 12 (192 бит), 14 (256 бит) |

---
## **Структура AES**
AES построен по принципу **SP-сети (Substitution-Permutation Network)** и состоит из нескольких основных операций, выполняемых в **раундах**.
Каждый раунд состоит из четырех операций:
1. **SubBytes** (подстановка байтов) — нелинейное преобразование.
2. **ShiftRows** (циклический сдвиг строк) — перестановка байтов.
3. **MixColumns** (перемешивание столбцов) — линейное преобразование.
4. **AddRoundKey** (добавление раундового ключа) — XOR с раундовым ключом.
### **Инициализация**
Перед первым раундом к входному блоку применяется **AddRoundKey** с исходным ключом.
### **Финальный раунд**
Последний раунд не содержит **MixColumns**, что делает алгоритм обратимым.
---
## **Подробное описание операций**
### **1. SubBytes (S-блоки)**
Каждый байт входного блока заменяется по **S-блоку**:
$$ S[i,j] = \text{таблица подстановки} $$
S-блок построен на основе обратных элементов в поле $GF(2^8)$, что обеспечивает стойкость к дифференциальному и линейному криптоанализу.
---
### **2. ShiftRows (Сдвиг строк)**
Производится циклический сдвиг строк влево:
- **1 строка**: без изменений.
- **2 строка**: сдвиг на 1 байт.
- **3 строка**: сдвиг на 2 байта.
- **4 строка**: сдвиг на 3 байта.
Это увеличивает диффузию и предотвращает подстановку по колонкам.

---
### **3. MixColumns (Перемешивание столбцов)**
Каждый столбец интерпретируется как полином в поле $GF(2^8)$ и умножается на фиксированную матрицу:
$$
\begin{bmatrix}
2 & 3 & 1 & 1 \\
1 & 2 & 3 & 1 \\
1 & 1 & 2 & 3 \\
3 & 1 & 1 & 2
\end{bmatrix}
\cdot
\begin{bmatrix}
b_0 \\
b_1 \\
b_2 \\
b_3
\end{bmatrix}
$$
---
### **4. AddRoundKey (XOR с раундовым ключом)**
Каждый байт складывается по XOR с соответствующим байтом **раундового ключа**:
$$ B_i = A_i \oplus K_i $$

---
## **Генерация раундовых ключей (Key Expansion)**
Ключи для раундов вычисляются на основе исходного ключа, применяя:
1. **SubWord** — замена байтов через S-блок.
2. **RotWord** — циклический сдвиг байтов.
3. **XOR с константами $Rcon[i]$**.

**Формулы вычисления ключей**:
$$ W[i] = W[i-4] \oplus g(W[i-1]) $$
Где $g(W[i])$ — функция преобразования с SubWord и RotWord.

---
## **Обратное шифрование (Расшифрование AES)**
Расшифрование выполняется обратными операциями:
- InvSubBytes (обратные S-блоки).
- InvShiftRows (сдвиг строк вправо).
- InvMixColumns (умножение на обратную матрицу).
- AddRoundKey (XOR с ключом).

---
## **Безопасность AES**
AES устойчив к большинству известных атак:
- **Дифференциальный криптоанализ** — высокая нелинейность S-блоков.
- **Линейный криптоанализ** — сложность атак $2^{128}$.
- **Атаки полного перебора** — сложность $2^{128}$, $2^{192}$, $2^{256}$.
- **Атаки на ключ** — AES-256 потенциально уязвим к атаке «Related-Key» (но не практической).

---
## **Режимы работы AES**
AES используется в следующих режимах:
- **ECB** (небезопасен, так как одинаковые блоки дают одинаковый шифротекст).
- **CBC** (более безопасен, использует начальный вектор).
- **CTR** (превращает блочный шифр в потоковый).
- **GCM** (обеспечивает аутентификацию данных).

---
## **Применение AES**
- **TLS, IPsec, VPN**.
- **Шифрование дисков (BitLocker, VeraCrypt)**.
- **Блокчейн, криптовалюты**.
- **Военные и государственные системы**.

---
## **Заключение**
AES — один из самых надежных и эффективных алгоритмов блочного шифрования, который широко применяется в различных системах защиты данных. Его безопасность основана на высокой стойкости к криптоанализу и длине ключей.
