# ГОСТ Р 34.13-2015. Режимы простой замены, режим выработки имитовставки

## Введение
ГОСТ Р 34.13-2015 определяет различные режимы работы блочных шифров, включая:
1. **Режимы простой замены**:
   - ECB (Electronic Codebook, Электронная кодовая книга)
   - CBC (Cipher Block Chaining, Связанные блоки)
2. **Режим выработки имитовставки (MAC, Message Authentication Code)**.
Режимы простой замены применяются для шифрования данных, а режим MAC используется для обеспечения целостности и аутентичности сообщений.

---

## Режимы простой замены

### **ECB (Electronic Codebook) — электронная кодовая книга**
Каждый блок открытого текста шифруется независимо:
$$ C_i = E(K, P_i) $$

### **Достоинства**
- Простота реализации.
- Параллельная обработка блоков.
### **Недостатки**
- Одинаковые блоки открытого текста шифруются одинаково, что делает его уязвимым к анализу.
- Уязвим к подмене блоков.

---

### **CBC (Cipher Block Chaining) — режим сцепления блоков**
Каждый блок перед шифрованием складывается по XOR с предыдущим зашифрованным блоком:
$$ C_i = E(K, P_i \oplus C_{i-1}) $$
Для первого блока:
$$ C_1 = E(K, P_1 \oplus IV) $$

### **Достоинства**
- Одинаковые блоки открытого текста шифруются по-разному.
- Устойчив к анализу частот.
### **Недостатки**
- Последовательная обработка блоков (нет параллельности).
- Требует случайного **IV**.

---

## Режим выработки имитовставки (MAC)

**MAC (Message Authentication Code)** — это криптографическая контрольная сумма, используемая для проверки целостности и аутентичности данных.
### **Алгоритм работы (на основе CBC-MAC)**
1. Сообщение разбивается на блоки $M_1, M_2, ..., M_n$.
2. Последовательное шифрование в режиме CBC:
   $$ C_1 = E(K, M_1) $$
   $$ C_2 = E(K, M_2 \oplus C_1) $$
   $$ C_n = E(K, M_n \oplus C_{n-1}) $$
3. Последний зашифрованный блок $C_n$ является **имитовставкой**.

### **Достоинства**
- Обеспечивает защиту от модификации данных.
- Используется в аутентификации.
### **Недостатки**
- Требует отдельного ключа.
- Уязвим к атакам, если ключ используется повторно.

---

## Заключение
Режимы **ECB** и **CBC** используются для шифрования данных, но **CBC** более безопасен. **MAC** необходим для проверки подлинности сообщений и их целостности.
